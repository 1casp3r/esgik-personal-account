<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Личный кабинет</title>
    <!-- Подключаем Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Подключаем иконки Lucide -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Шрифт Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            color: #1f2937;
        }
        /* Стили для боковой панели */
        .sidebar {
            transition: transform 0.3s ease-in-out;
            transform: translateX(-100%);
        }
        .sidebar.open {
            transform: translateX(0);
        }
        .main-content {
            transition: margin-left 0.3s ease-in-out;
        }
        @media (min-width: 768px) {
            .sidebar {
                transform: translateX(0);
            }
            .main-content {
                margin-left: 16rem; /* Ширина сайдбара */
            }
        }
        /* Стили для скроллбара */
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        /* Скрываем вкладки по умолчанию */
        .tab-content.hidden {
            display: none;
        }
        /* Стили для модального окна */
        .modal {
            display: none;
        }
        .modal.open {
            display: flex;
        }
        .lucide {
            display: inline-block;
        }
    </style>
</head>
<body class="bg-gray-100 font-sans text-gray-900">

    <!-- Боковая панель -->
    <aside id="sidebar" class="sidebar fixed inset-y-0 left-0 z-50 w-64 bg-gray-900 text-white p-6 shadow-lg flex flex-col md:translate-x-0 transition-transform">
        <div class="flex items-center justify-between mb-8">
            <h1 class="text-xl font-bold">ЕСГИК</h1>
            <button id="close-sidebar-btn" class="text-gray-400 hover:text-white md:hidden">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
            </button>
        </div>
        <nav class="flex-1 space-y-2">
            <a href="#" data-tab="dashboard" class="tab-button flex items-center gap-3 rounded-lg px-4 py-3 text-gray-300 hover:bg-gray-800 hover:text-white transition-colors duration-200">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-layout-dashboard"><rect width="7" height="9" x="3" y="3" rx="1"/><rect width="7" height="5" x="14" y="3" rx="1"/><rect width="7" height="9" x="14" y="12" rx="1"/><rect width="7" height="5" x="3" y="16" rx="1"/></svg>
                <span>Дашборд</span>
            </a>
            <a href="#" data-tab="objects" class="tab-button flex items-center gap-3 rounded-lg px-4 py-3 text-gray-300 hover:bg-gray-800 hover:text-white transition-colors duration-200">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-building-2"><path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18"/><path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"/><path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"/><path d="M10 6h4"/><path d="M10 10h4"/><path d="M10 14h4"/><path d="M10 18h4"/></svg>
                <span>Мои объекты</span>
            </a>
            <a href="#" data-tab="services" class="tab-button flex items-center gap-3 rounded-lg px-4 py-3 text-gray-300 hover:bg-gray-800 hover:text-white transition-colors duration-200">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shopping-cart"><circle cx="8" cy="21" r="1"/><circle cx="19" cy="21" r="1"/><path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/></svg>
                <span>Каталог услуг</span>
            </a>
            <a href="#" data-tab="profile" class="tab-button flex items-center gap-3 rounded-lg px-4 py-3 text-gray-300 hover:bg-gray-800 hover:text-white transition-colors duration-200">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-circle-user"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="10" r="3"/><path d="M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662"/></svg>
                <span>Профиль</span>
            </a>
            <a href="#" data-tab="personal-data" class="tab-button flex items-center gap-3 rounded-lg px-4 py-3 text-gray-300 hover:bg-gray-800 hover:text-white transition-colors duration-200">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-text"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/><path d="M10 9H8"/><path d="M16 13H8"/><path d="M16 17H8"/></svg>
                <span>Персональные данные</span>
            </a>
            <a href="#" data-tab="partnership" class="tab-button flex items-center gap-3 rounded-lg px-4 py-3 text-gray-300 hover:bg-gray-800 hover:text-white transition-colors duration-200">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-users"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                <span>Партнерство</span>
            </a>
        </nav>
        <div class="mt-auto pt-6 border-t border-gray-700">
            <a href="#" data-tab="help" class="tab-button flex items-center gap-3 rounded-lg px-4 py-3 text-gray-300 hover:bg-gray-800 hover:text-white transition-colors duration-200">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-circle-help"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><path d="M12 17h.01"/></svg>
                <span>Помощь</span>
            </a>
            <a href="#" class="flex items-center gap-3 rounded-lg px-4 py-3 text-gray-300 hover:bg-gray-800 hover:text-white transition-colors duration-200">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-log-out"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" x2="9" y1="12" y2="12"/></svg>
                <span>Выход</span>
            </a>
        </div>
    </aside>

    <!-- Основное содержимое -->
    <div id="main-content" class="main-content min-h-screen p-6 md:ml-64 transition-all">
        <!-- Шапка с кнопками -->
        <header class="flex items-center justify-between py-4">
            <button id="open-sidebar-btn" class="text-gray-900 md:hidden">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-align-left"><line x1="21" x2="3" y1="6" y2="6"/><line x1="15" x2="3" y1="12" y2="12"/><line x1="17" x2="3" y1="18" y2="18"/></svg>
            </button>
            <div class="flex-1"></div>
            <div class="flex items-center space-x-4">
                <button id="help-btn" class="relative rounded-full p-2 bg-white text-gray-600 hover:text-gray-900 transition-colors duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-help-circle"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><path d="M12 17h.01"/></svg>
                </button>
                <button id="notifications-btn" class="relative rounded-full p-2 bg-white text-gray-600 hover:text-gray-900 transition-colors duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bell"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>
                    <span class="absolute top-1 right-1 h-2 w-2 bg-red-500 rounded-full animate-pulse"></span>
                </button>
                <div class="flex items-center gap-2">
                    <div class="w-8 h-8 rounded-full bg-gray-300"></div>
                    <span class="font-medium text-sm">Иван Иванов</span>
                </div>
            </div>
        </header>

        <!-- Содержимое вкладок -->
        <div class="mt-6 space-y-6">
            <!-- Вкладка "Дашборд" -->
            <div id="dashboard" class="tab-content">
                <h2 class="text-3xl font-bold mb-6">Дашборд</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                    <div class="bg-white p-6 rounded-xl shadow-lg">
                        <h3 class="text-sm font-medium text-gray-500">Активные объекты</h3>
                        <div class="text-4xl font-bold mt-1">4</div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-lg">
                        <h3 class="text-sm font-medium text-gray-500">Завершенные объекты</h3>
                        <div class="text-4xl font-bold mt-1">12</div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-lg">
                        <h3 class="text-sm font-medium text-gray-500">Общая сумма заказов</h3>
                        <div class="text-4xl font-bold mt-1">1,250,000 ₽</div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-lg">
                        <h3 class="text-sm font-medium text-gray-500">Потрачено бонусов</h3>
                        <div class="text-4xl font-bold mt-1">1,200</div>
                    </div>
                </div>

                <div class="mb-6 rounded-lg p-4 text-sm text-green-800 border border-green-300 bg-green-50 hidden" role="alert" id="syncResultAlert">
                    <p class="font-medium">Результат синхронизации с CRM</p>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-xl font-semibold">Последние объекты</h3>
                        <button id="syncCrmBtn" class="flex items-center rounded-lg bg-gray-200 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-300 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw mr-2 h-4 w-4"><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.79 2.87L3 7"/><path d="M3 3v4h4"/><path d="M3 12a9 9 0 0 0 9 9 9.75 9 0 0 0 6.79-2.87L21 17"/><path d="M21 21v-4h-4"/></svg>
                            Синхронизировать с CRM
                        </button>
                    </div>
                    <div id="objects-list-dashboard" class="space-y-4">
                        <!-- Объекты будут отрисованы здесь -->
                    </div>
                </div>
            </div>

            <!-- Вкладка "Мои объекты" -->
            <div id="objects" class="tab-content hidden">
                <h2 class="text-3xl font-bold mb-6">Мои объекты</h2>
                <div id="objects-list" class="space-y-4">
                    <!-- Список объектов будет отрисован здесь -->
                </div>
            </div>

            <!-- Вкладка "Каталог услуг" -->
            <div id="services" class="tab-content hidden">
                <h2 class="text-3xl font-bold mb-6">Каталог услуг</h2>
                <div id="services-catalog" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Каталог услуг будет отрисован здесь -->
                </div>
            </div>

            <!-- Вкладка "Профиль" -->
            <div id="profile" class="tab-content hidden">
                <h2 class="text-3xl font-bold mb-6">Настройка профиля</h2>
                <div class="bg-white p-6 rounded-xl shadow-lg max-w-2xl mx-auto">
                    <form id="profile-form">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                            <div class="space-y-2">
                                <label for="first_name" class="block text-sm font-medium text-gray-700">Имя</label>
                                <input type="text" id="first_name" name="first_name" class="w-full rounded-md border border-gray-300 p-2 focus:ring-blue-500 focus:border-blue-500" value="Иван">
                            </div>
                            <div class="space-y-2">
                                <label for="last_name" class="block text-sm font-medium text-gray-700">Фамилия</label>
                                <input type="text" id="last_name" name="last_name" class="w-full rounded-md border border-gray-300 p-2 focus:ring-blue-500 focus:border-blue-500" value="Иванов">
                            </div>
                            <div class="space-y-2">
                                <label for="middle_name" class="block text-sm font-medium text-gray-700">Отчество</label>
                                <input type="text" id="middle_name" name="middle_name" class="w-full rounded-md border border-gray-300 p-2 focus:ring-blue-500 focus:border-blue-500" value="Иванович">
                            </div>
                            <div class="space-y-2">
                                <label for="phone" class="block text-sm font-medium text-gray-700">Телефон</label>
                                <input type="tel" id="phone" name="phone" class="w-full rounded-md border border-gray-300 p-2 focus:ring-blue-500 focus:border-blue-500" value="+7 (999) 123-45-67">
                            </div>
                            <div class="space-y-2">
                                <label for="email" class="block text-sm font-medium text-gray-700">Email</label>
                                <input type="email" id="email" name="email" class="w-full rounded-md border border-gray-300 p-2 focus:ring-blue-500 focus:border-blue-500" value="ivanov@example.com">
                            </div>
                        </div>
                        <div class="space-y-4 mb-6">
                            <div>
                                <h3 class="text-lg font-semibold mb-2">Способ оплаты</h3>
                                <div class="flex items-center gap-4">
                                    <input type="radio" id="cash" name="payment_method" value="cash" class="form-radio text-blue-600">
                                    <label for="cash" class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-wallet"><path d="M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h12a2 2 0 0 1 0 4H5a2 2 0 0 0 0 4h12a2 2 0 0 1 0 4h-4"/><path d="M20 12h-2a2 2 0 0 0-2 2v2"/></svg>Наличные</label>
                                    <input type="radio" id="card" name="payment_method" value="card" class="form-radio text-blue-600" checked>
                                    <label for="card" class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-credit-card"><rect width="20" height="14" x="2" y="5" rx="2"/><line x1="2" x2="22" y1="10" y2="10"/></svg>Карта</label>
                                </div>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold mb-2">Способ доставки документов</h3>
                                <div class="flex items-center gap-4">
                                    <input type="radio" id="office" name="delivery_method" value="office" class="form-radio text-blue-600">
                                    <label for="office" class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-building"><rect width="16" height="16" x="4" y="2" rx="2" ry="2"/><path d="M9 22v-4h6v4"/><path d="M8 6h.01"/><path d="M16 6h.01"/><path d="M12 6h.01"/><path d="M12 10h.01"/><path d="M12 14h.01"/><path d="M16 10h.01"/><path d="M16 14h.01"/><path d="M8 10h.01"/><path d="M8 14h.01"/></svg>В офисе</label>
                                    <input type="radio" id="delivery" name="delivery_method" value="delivery" class="form-radio text-blue-600" checked>
                                    <label for="delivery" class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-truck"><path d="M10 18H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v2"/><path d="M2 18h2"/><path d="M15 18h2"/><path d="M17 12h-2"/><path d="M7 18v2"/><path d="M17 18v2"/></svg>Доставка</label>
                                </div>
                            </div>
                        </div>
                        <div class="space-y-2 mb-6">
                            <label for="promo_code" class="block text-sm font-medium text-gray-700">Промокод</label>
                            <div class="flex items-center gap-2">
                                <input type="text" id="promo_code" name="promo_code" class="flex-1 rounded-md border border-gray-300 p-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Введите промокод">
                                <button type="button" id="apply-promo-btn" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors">Применить</button>
                            </div>
                            <p id="promo-message" class="text-sm mt-2"></p>
                        </div>
                        <div class="bg-gray-50 p-4 rounded-xl">
                            <h3 class="text-lg font-semibold mb-3">Расчет стоимости</h3>
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between">
                                    <span>Услуга:</span>
                                    <span>Межевой план</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Стоимость:</span>
                                    <span id="total-amount"></span>
                                </div>
                                <div id="discount-row" class="flex justify-between text-green-600 hidden">
                                    <span>Скидка (<span id="discount-code"></span>):</span>
                                    <span id="discount-amount"></span>
                                </div>
                                <div class="border-t pt-2 flex justify-between font-medium">
                                    <span>К оплате:</span>
                                    <span id="final-amount"></span>
                                </div>
                            </div>
                        </div>
                        <div class="mt-6 flex justify-end">
                            <button type="submit" class="px-6 py-3 bg-blue-600 text-white rounded-md shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">Сохранить изменения</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Вкладка "Персональные данные" -->
            <div id="personal-data" class="tab-content hidden">
                <h2 class="text-3xl font-bold mb-6">Персональные данные</h2>
                <div class="bg-white p-6 rounded-xl shadow-lg max-w-2xl mx-auto">
                    <form id="personal-data-form">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                            <div class="space-y-2">
                                <label for="passport_series" class="block text-sm font-medium text-gray-700">Серия паспорта</label>
                                <input type="text" id="passport_series" name="passport_series" class="w-full rounded-md border border-gray-300 p-2 focus:ring-blue-500 focus:border-blue-500" value="0000">
                            </div>
                            <div class="space-y-2">
                                <label for="passport_number" class="block text-sm font-medium text-gray-700">Номер паспорта</label>
                                <input type="text" id="passport_number" name="passport_number" class="w-full rounded-md border border-gray-300 p-2 focus:ring-blue-500 focus:border-blue-500" value="000000">
                            </div>
                            <div class="space-y-2">
                                <label for="passport_issued_by" class="block text-sm font-medium text-gray-700">Кем выдан</label>
                                <input type="text" id="passport_issued_by" name="passport_issued_by" class="w-full rounded-md border border-gray-300 p-2 focus:ring-blue-500 focus:border-blue-500" value="ГУ МВД России по г. Москве">
                            </div>
                            <div class="space-y-2">
                                <label for="passport_issued_date" class="block text-sm font-medium text-gray-700">Дата выдачи</label>
                                <input type="date" id="passport_issued_date" name="passport_issued_date" class="w-full rounded-md border border-gray-300 p-2 focus:ring-blue-500 focus:border-blue-500" value="2022-01-01">
                            </div>
                            <div class="space-y-2">
                                <label for="passport_registration_address" class="block text-sm font-medium text-gray-700">Адрес регистрации</label>
                                <input type="text" id="passport_registration_address" name="passport_registration_address" class="w-full rounded-md border border-gray-300 p-2 focus:ring-blue-500 focus:border-blue-500" value="г. Москва, ул. Ленина, д. 1">
                            </div>
                        </div>
                        <div class="mt-6 flex justify-end">
                            <button type="submit" class="px-6 py-3 bg-blue-600 text-white rounded-md shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">Сохранить данные</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Вкладка "Партнерство" -->
            <div id="partnership" class="tab-content hidden">
                <h2 class="text-3xl font-bold mb-6">Партнерство</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-lg">
                        <h3 class="text-xl font-semibold mb-4">Мои контрагенты</h3>
                        <div id="partner-clients-list" class="space-y-4">
                            <!-- Контрагенты будут отрисованы здесь -->
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-lg">
                        <h3 class="text-xl font-semibold mb-4">Заказы партнеров</h3>
                        <div id="partner-orders-list" class="space-y-4">
                            <!-- Заказы будут отрисованы здесь -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Вкладка "Помощь" -->
            <div id="help" class="tab-content hidden">
                <h2 class="text-3xl font-bold mb-6">Помощь</h2>
                <div class="bg-white p-6 rounded-xl shadow-lg max-w-2xl mx-auto">
                    <div class="space-y-4 text-gray-800">
                        <div>
                            <h4 class="font-medium mb-2">Общие вопросы</h4>
                            <ul class="text-sm list-disc pl-5 space-y-2">
                                <li><strong>Как заказать услугу?</strong> Перейдите в раздел "Каталог услуг", выберите нужную услугу и оформите заказ.</li>
                                <li><strong>Как отследить статус заказа?</strong> Все заказы отображаются в разделе "Мои объекты" с актуальным статусом.</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-medium mb-2">Контактная информация</h4>
                            <div class="space-y-3 text-sm">
                                <div class="flex items-center gap-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-phone-call h-4 w-4 text-green-600"><path d="M22 16.92v3a2 2 0 0 1-2.18 2A19.79 19.79 0 0 1 8.64 2.18 2 2 0 0 1 10.64 0H14.92A2 2 0 0 1 17 2v2.18l-3.27 3.27L10.73 7.5L7.46 4.23l-3.27-3.27"/></svg>
                                    <span class="font-medium">8 (495) 127 75-73</span>
                                </div>
                                <div class="flex items-start gap-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-map-pin h-4 w-4 text-blue-600 mt-0.5"><path d="M12 2a8 8 0 0 0-8 8c0 7.33 8 13 8 13s8-5.67 8-13a8 8 0 0 0-8-8z"/><circle cx="12" cy="10" r="3"/></svg>
                                    <span>г. Орехово-Зуево, ул. Бабушкина д.2а, 5 этаж, офис 10</span>
                                </div>
                                <div class="flex items-start gap-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clock h-4 w-4 text-orange-600 mt-0.5"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                                    <span>Обслуживаемые города: Орехово-Зуево, Павловский Посад, Воскресенск, Шатура, Электрогорск, Ликино-Дулёво</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Модальное окно заказа услуги -->
    <div id="order-service-modal" class="modal fixed inset-0 z-50 bg-gray-900 bg-opacity-75 items-center justify-center p-4 transition-opacity duration-300">
        <div class="bg-white rounded-xl shadow-lg max-w-lg w-full p-6 relative animate-fade-in-up">
            <button id="close-order-modal" class="absolute top-4 right-4 text-gray-500 hover:text-gray-800">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
            </button>
            <h3 class="text-xl font-semibold mb-4">Оформление заказа: <span id="service-name-modal"></span></h3>
            <form id="order-service-form">
                <input type="hidden" id="service-id" name="service_id">
                <div class="space-y-4 mb-6">
                    <div>
                        <label for="address" class="block text-sm font-medium text-gray-700">Адрес объекта</label>
                        <input type="text" id="address" name="address" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" placeholder="Например, г. Орехово-Зуево, ул. Ленина, д. 10">
                    </div>
                    <div>
                        <label for="cadastral_number" class="block text-sm font-medium text-gray-700">Кадастровый номер (если есть)</label>
                        <input type="text" id="cadastral_number" name="cadastral_number" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" placeholder="Например, 50:24:0000000:123">
                    </div>
                    <div>
                        <label for="comment" class="block text-sm font-medium text-gray-700">Комментарий</label>
                        <textarea id="comment" name="comment" rows="3" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" placeholder="Опишите детали заказа..."></textarea>
                    </div>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg mb-6">
                    <h4 class="font-medium mb-2">Стоимость услуги</h4>
                    <div class="flex justify-between items-center">
                        <span><span id="service-name-cost-modal"></span></span>
                        <span class="font-bold" id="service-price-modal"></span>
                    </div>
                    <p class="text-sm text-gray-600 mt-2">
                        Точная стоимость будет рассчитана после осмотра объекта
                    </p>
                </div>
                <div class="flex gap-2">
                    <button type="submit" id="submit-order-btn" class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-md shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                        Оформить заказ
                    </button>
                </div>
            </form>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- Имитация данных с бэкенда ---
            const objectsData = [
                { id: 1, type: "Межевой план", address: "г. Орехово-Зуево, ул. Ленина, д. 15", status: "in_progress", date: "2023-10-26" },
                { id: 2, type: "Технический план", address: "г. Павловский Посад, ул. Мира, д. 7", status: "completed", date: "2023-09-18" },
                { id: 3, type: "Схема расположения", address: "г. Электрогорск, ул. Горького, д. 32", status: "new", date: "2023-10-28" },
                { id: 4, type: "Акт обследования", address: "г. Шатура, ул. Советская, д. 50", status: "in_progress", date: "2023-10-20" }
            ];

            const servicesData = [
                { id: 1, name: "Межевой план", description: "Межевой план — документ, необходимый для кадастрового учета земельных участков.", base_price: 15000 },
                { id: 2, name: "Технический план", description: "Технический план — документ, содержащий сведения об объекте недвижимости для постановки на кадастровый учет.", base_price: 12000 },
                { id: 3, name: "Акт обследования", description: "Акт обследования — документ, подтверждающий прекращение существования объекта недвижимости.", base_price: 8000 },
                { id: 4, name: "Схема расположения", description: "Схема расположения — графическое изображение границ земельного участка на кадастровой карте.", base_price: 7000 },
            ];
            
            const partnerOrdersData = [
                { id: 1, client: 'ООО "СтройИнвест"', service: 'Межевой план', status: 'completed', commission: 2500, date: '2023-10-20' },
                { id: 2, client: 'ИП Смирнов А.П.', service: 'Технический план', status: 'in_progress', commission: 1800, date: '2023-10-25' },
                { id: 3, client: 'Физическое лицо', service: 'Акт обследования', status: 'new', commission: 1000, date: '2023-10-28' },
            ];

            const partnerClientsData = [
                { id: 1, name: 'ООО "СтройИнвест"', phone: '+79991112233', email: 'stroiinvest@example.com' },
                { id: 2, name: 'ИП Смирнов А.П.', phone: '+79994445566', email: 'smirnov@example.com' },
            ];
            
            const promocodesData = [
                { code: 'ESGIK10', discount_type: 'percentage', discount_value: 10 },
                { code: 'OCTOBER500', discount_type: 'fixed', discount_value: 500 }
            ];

            const profileData = {
                firstName: 'Иван',
                lastName: 'Иванов',
                middleName: 'Иванович',
                phone: '+7 (999) 123-45-67',
                email: 'ivanov@example.com',
                paymentMethod: 'card',
                deliveryMethod: 'delivery'
            };

            const personalData = {
                passportSeries: '0000',
                passportNumber: '000000',
                passportIssuedBy: 'ГУ МВД России по г. Москве',
                passportIssuedDate: '2022-01-01',
                passportRegistrationAddress: 'г. Москва, ул. Ленина, д. 1'
            };
            
            // --- Переключение вкладок ---
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');

            tabButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetTab = e.currentTarget.dataset.tab;

                    // Скрыть все содержимое вкладок
                    tabContents.forEach(content => content.classList.add('hidden'));

                    // Показать содержимое выбранной вкладки
                    const activeContent = document.getElementById(targetTab);
                    if (activeContent) {
                        activeContent.classList.remove('hidden');
                    }

                    // Обновить активный класс для кнопок
                    tabButtons.forEach(btn => btn.classList.remove('bg-gray-800', 'text-white'));
                    e.currentTarget.classList.add('bg-gray-800', 'text-white');
                    
                    // Скрыть боковую панель на мобильных
                    const sidebar = document.getElementById('sidebar');
                    if (window.innerWidth < 768) {
                        sidebar.classList.remove('open');
                    }
                });
            });

            // Инициализация первой вкладки
            document.getElementById('dashboard').classList.remove('hidden');
            document.querySelector('[data-tab="dashboard"]').classList.add('bg-gray-800', 'text-white');

            // --- Функции рендеринга данных ---

            function renderObjects(data, containerId) {
                const container = document.getElementById(containerId);
                if (!container) return;
                container.innerHTML = '';
                
                if (data.length === 0) {
                    container.innerHTML = `<p class="text-gray-500 text-center">У вас пока нет объектов.</p>`;
                    return;
                }

                data.forEach(obj => {
                    let statusColor = '';
                    switch (obj.status) {
                        case 'new':
                            statusColor = 'bg-gray-100 text-gray-800';
                            break;
                        case 'in_progress':
                            statusColor = 'bg-blue-100 text-blue-800';
                            break;
                        case 'completed':
                            statusColor = 'bg-green-100 text-green-800';
                            break;
                        case 'cancelled':
                            statusColor = 'bg-red-100 text-red-800';
                            break;
                        default:
                            statusColor = 'bg-gray-100 text-gray-800';
                    }

                    const statusLabel = {
                        'new': 'Новый',
                        'in_progress': 'В работе',
                        'completed': 'Завершен',
                        'cancelled': 'Отменен'
                    }[obj.status] || 'Неизвестно';

                    const item = document.createElement('div');
                    item.className = 'bg-white p-4 rounded-xl shadow-sm border border-gray-200';
                    item.innerHTML = `
                        <div class="flex items-center justify-between mb-2">
                            <h4 class="font-semibold text-lg">${obj.type}</h4>
                            <span class="inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${statusColor}">${statusLabel}</span>
                        </div>
                        <p class="text-gray-600 text-sm mb-2"><span class="font-medium">Адрес:</span> ${obj.address}</p>
                        <p class="text-gray-500 text-xs">Дата заказа: ${obj.date}</p>
                    `;
                    container.appendChild(item);
                });
            }

            function renderServicesCatalog(data, containerId) {
                const container = document.getElementById(containerId);
                if (!container) return;
                container.innerHTML = '';

                if (data.length === 0) {
                    container.innerHTML = `<p class="text-gray-500 text-center col-span-full">Услуги временно недоступны.</p>`;
                    return;
                }

                data.forEach(service => {
                    const card = document.createElement('div');
                    card.className = 'bg-white p-6 rounded-xl shadow-lg flex flex-col justify-between';
                    card.innerHTML = `
                        <div>
                            <h3 class="text-xl font-semibold mb-2">${service.name}</h3>
                            <p class="text-gray-600 text-sm mb-4">${service.description}</p>
                        </div>
                        <div class="mt-4">
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <h4 class="font-medium mb-2">Стоимость услуги</h4>
                                <div class="flex justify-between items-center">
                                    <span>${service.name}</span>
                                    <span class="font-bold">от ${service.base_price.toLocaleString()} ₽</span>
                                </div>
                                <p class="text-sm text-gray-600 mt-2">
                                    Точная стоимость будет рассчитана после осмотра объекта
                                </p>
                            </div>
                            <div class="flex gap-2 mt-4">
                                <button class="order-service-btn flex-1 px-4 py-2 bg-blue-600 text-white rounded-md shadow-md hover:bg-blue-700" data-service-id="${service.id}">
                                    Оформить заказ
                                </button>
                            </div>
                        </div>
                    `;
                    container.appendChild(card);
                });
            }

            function renderPartnerOrders(data, containerId) {
                const container = document.getElementById(containerId);
                if (!container) return;
                container.innerHTML = '';
                if (data.length === 0) {
                    container.innerHTML = `<p class="text-gray-500 text-center">У вас пока нет партнерских заказов.</p>`;
                    return;
                }
                data.forEach(order => {
                    let statusColor = '';
                    switch (order.status) {
                        case 'new':
                            statusColor = 'bg-gray-100 text-gray-800';
                            break;
                        case 'in_progress':
                            statusColor = 'bg-blue-100 text-blue-800';
                            break;
                        case 'completed':
                            statusColor = 'bg-green-100 text-green-800';
                            break;
                        case 'cancelled':
                            statusColor = 'bg-red-100 text-red-800';
                            break;
                    }
                    const statusLabel = {
                        'new': 'Новый',
                        'in_progress': 'В работе',
                        'completed': 'Завершен',
                        'cancelled': 'Отменен'
                    }[order.status] || 'Неизвестно';
                    const item = document.createElement('div');
                    item.className = 'bg-gray-50 p-4 rounded-xl shadow-sm border border-gray-200';
                    item.innerHTML = `
                        <div class="flex items-center justify-between mb-1">
                            <h4 class="font-semibold text-base">${order.client}</h4>
                            <span class="inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${statusColor}">${statusLabel}</span>
                        </div>
                        <p class="text-sm text-gray-600">Услуга: ${order.service}</p>
                        <p class="text-sm text-gray-600">Комиссия: <span class="font-medium text-green-600">${order.commission.toLocaleString()} ₽</span></p>
                        <p class="text-xs text-gray-500 mt-1">Дата: ${order.date}</p>
                    `;
                    container.appendChild(item);
                });
            }
            
            function renderPartnerClients(data, containerId) {
                const container = document.getElementById(containerId);
                if (!container) return;
                container.innerHTML = '';
                if (data.length === 0) {
                    container.innerHTML = `<p class="text-gray-500 text-center">У вас пока нет контрагентов.</p>`;
                    return;
                }
                data.forEach(client => {
                    const item = document.createElement('div');
                    item.className = 'bg-gray-50 p-4 rounded-xl shadow-sm border border-gray-200';
                    item.innerHTML = `
                        <h4 class="font-semibold text-base mb-1">${client.name}</h4>
                        <p class="text-sm text-gray-600">Телефон: ${client.phone}</p>
                        <p class="text-sm text-gray-600">Email: ${client.email}</p>
                    `;
                    container.appendChild(item);
                });
            }

            function populateProfileForm(data) {
                const form = document.getElementById('profile-form');
                if (form) {
                    form.querySelector('#first_name').value = data.firstName;
                    form.querySelector('#last_name').value = data.lastName;
                    form.querySelector('#middle_name').value = data.middleName;
                    form.querySelector('#phone').value = data.phone;
                    form.querySelector('#email').value = data.email;
                    form.querySelector(`input[name="payment_method"][value="${data.paymentMethod}"]`).checked = true;
                    form.querySelector(`input[name="delivery_method"][value="${data.deliveryMethod}"]`).checked = true;
                }
            }

            function populatePersonalDataForm(data) {
                const form = document.getElementById('personal-data-form');
                if (form) {
                    form.querySelector('#passport_series').value = data.passportSeries;
                    form.querySelector('#passport_number').value = data.passportNumber;
                    form.querySelector('#passport_issued_by').value = data.passportIssuedBy;
                    form.querySelector('#passport_issued_date').value = data.passportIssuedDate;
                    form.querySelector('#passport_registration_address').value = data.passportRegistrationAddress;
                }
            }


            // --- Логика открытия/закрытия боковой панели на мобильных ---
            const openSidebarBtn = document.getElementById('open-sidebar-btn');
            const closeSidebarBtn = document.getElementById('close-sidebar-btn');
            const sidebar = document.getElementById('sidebar');

            openSidebarBtn.addEventListener('click', () => {
                sidebar.classList.add('open');
            });

            closeSidebarBtn.addEventListener('click', () => {
                sidebar.classList.remove('open');
            });
            
            // --- Логика синхронизации с CRM ---
            const syncCrmBtn = document.getElementById('syncCrmBtn');
            const syncResultAlert = document.getElementById('syncResultAlert');

            syncCrmBtn.addEventListener('click', () => {
                syncCrmBtn.disabled = true;
                syncCrmBtn.innerHTML = `
                    <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    Синхронизация...
                `;

                // Имитация задержки
                setTimeout(() => {
                    const success = Math.random() > 0.3; // Имитация ошибки
                    const resultMessage = success ? 'Данные успешно синхронизированы.' : 'Ошибка синхронизации. Попробуйте еще раз.';
                    const resultColor = success ? 'bg-green-50 text-green-800 border-green-300' : 'bg-red-50 text-red-800 border-red-300';
                    
                    syncResultAlert.querySelector('p').textContent = resultMessage;
                    syncResultAlert.className = `rounded-lg border px-4 py-3 text-sm ${resultColor}`;
                    syncResultAlert.classList.remove('hidden');
                    
                    // Сброс состояния кнопки
                    syncCrmBtn.disabled = false;
                    syncCrmBtn.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw mr-2 h-4 w-4"><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.79 2.87L3 7"/><path d="M3 3v4h4"/><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.79-2.87L21 17"/><path d="M21 21v-4h-4"/></svg>
                        Синхронизировать с CRM
                    `;
                }, 2000);
            });
            
            // --- Логика модального окна заказа услуги ---
            const orderModal = document.getElementById('order-service-modal');
            const orderForm = document.getElementById('order-service-form');
            const serviceNameModal = document.getElementById('service-name-modal');
            const serviceNameCostModal = document.getElementById('service-name-cost-modal');
            const servicePriceModal = document.getElementById('service-price-modal');
            const serviceIdInput = document.getElementById('service-id');
            const closeOrderModalBtn = document.getElementById('close-order-modal');

            document.addEventListener('click', (e) => {
                if (e.target.closest('.order-service-btn')) {
                    const serviceId = parseInt(e.target.closest('.order-service-btn').dataset.serviceId);
                    const service = servicesData.find(s => s.id === serviceId);
                    
                    if (service) {
                        serviceNameModal.textContent = service.name;
                        serviceNameCostModal.textContent = service.name;
                        servicePriceModal.textContent = `от ${service.base_price.toLocaleString()} ₽`;
                        serviceIdInput.value = service.id;
                        orderModal.classList.add('open');
                    }
                }
            });
            
            closeOrderModalBtn.addEventListener('click', () => {
                orderModal.classList.remove('open');
            });
            
            orderForm.addEventListener('submit', (e) => {
                e.preventDefault();
                alert('Заказ успешно оформлен! Данные будут отправлены в CRM.');
                orderModal.classList.remove('open');
            });
            
            // --- Логика применения промокода ---
            const applyPromoBtn = document.getElementById('apply-promo-btn');
            const promoCodeInput = document.getElementById('promo_code');
            const promoMessage = document.getElementById('promo-message');
            const totalAmountEl = document.getElementById('total-amount');
            const finalAmountEl = document.getElementById('final-amount');
            const discountRowEl = document.getElementById('discount-row');
            const discountCodeEl = document.getElementById('discount-code');
            const discountAmountEl = document.getElementById('discount-amount');

            // Исходная сумма заказа (для примера)
            const totalAmount = 15000;
            totalAmountEl.textContent = `${totalAmount.toLocaleString()} ₽`;
            finalAmountEl.textContent = `${totalAmount.toLocaleString()} ₽`;

            applyPromoBtn.addEventListener('click', () => {
                const enteredCode = promoCodeInput.value.trim().toUpperCase();
                const promo = promocodesData.find(p => p.code === enteredCode);
                
                let discountAmount = 0;
                
                if (promo) {
                    if (promo.discount_type === 'percentage') {
                        discountAmount = totalAmount * (promo.discount_value / 100);
                    } else {
                        discountAmount = promo.discount_value;
                    }
                    const finalAmount = totalAmount - discountAmount;
                    
                    discountCodeEl.textContent = promo.code;
                    discountAmountEl.textContent = `- ${discountAmount.toLocaleString()} ₽`;
                    finalAmountEl.textContent = `${finalAmount.toLocaleString()} ₽`;
                    
                    discountRowEl.classList.remove('hidden');
                    promoMessage.textContent = 'Промокод успешно применен!';
                    promoMessage.className = 'text-sm mt-2 text-green-600';
                } else {
                    // Сброс к исходным значениям
                    discountRowEl.classList.add('hidden');
                    finalAmountEl.textContent = `${totalAmount.toLocaleString()} ₽`;
                    
                    promoMessage.textContent = 'Неверный промокод';
                    promoMessage.className = 'text-sm mt-2 text-red-600';
                }
            });

            // --- Инициализация при загрузке страницы ---
            renderObjects(objectsData, 'objects-list');
            renderObjects(objectsData.slice(0, 2), 'objects-list-dashboard'); // Для дашборда показываем только 2 объекта
            renderPartnerOrders(partnerOrdersData, 'partner-orders-list');
            renderPartnerClients(partnerClientsData, 'partner-clients-list');
            renderServicesCatalog(servicesData, 'services-catalog');
            populateProfileForm(profileData);
            populatePersonalDataForm(personalData);
        });
    </script>
</body>
</html>
